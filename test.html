<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Me @ GitHub - Test Page</title>
    <meta name="user-login" content="patrick-knight">
    <link rel="stylesheet" href="styles.css">
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui; margin: 40px; }
        .gh-header-number { font-size: 24px; color: #656d76; }
        h1 { font-size: 24px; }
        .content { margin-top: 20px; line-height: 1.6; }
        .comment { background: #f6f8fa; padding: 10px; margin: 10px 0; border-radius: 6px; }
        button { margin: 10px 0; padding: 8px 16px; }
        .test-info { background: #fff3cd; padding: 10px; margin: 20px 0; border-radius: 6px; border: 1px solid #ffeaa7; }
        .spacer { height: 1000px; }
        .fake-github-popup { 
            position: fixed; 
            top: 100px; 
            right: 100px; 
            background: #0969da; 
            color: white; 
            padding: 20px; 
            border-radius: 6px; 
            z-index: 999999; 
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
        }
        .fake-github-modal { 
            position: fixed; 
            top: 200px; 
            right: 200px; 
            background: #f6f8fa; 
            border: 1px solid #d0d7de; 
            padding: 15px; 
            border-radius: 6px; 
            z-index: 1000000; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
    </style>
</head>
<body>
    <h1>
        <span class="gh-header-number">#9373</span>
        Test Issue for Me @ GitHub Extension
    </h1>

    <div class="content">
        <div class="comment">
            <p>Hey @patrick-knight, can you take a look at this issue?</p>
        </div>

        <div class="comment">
            <p>Thanks for the feedback @patrick-knight! I'll make those changes.</p>
        </div>

        <div class="comment">
            <p>@patrick-knight mentioned this in another issue as well.</p>
        </div>

        <div class="comment js-timeline-item">
            <p>This is a comment that will be loaded via "load more" simulation.</p>
            <p>Another mention of @patrick-knight here!</p>
        </div>

        <button onclick="loadMoreContent()">Load More</button>

        <div id="more-content" style="display: none;">
            <div class="comment js-comment">
                <p>This content was loaded dynamically and contains @patrick-knight mention.</p>
            </div>
            <div class="comment js-comment">
                <p>Final mention of @patrick-knight in this thread.</p>
            </div>
        </div>

        <div class="test-info">
            <strong>Testing Instructions:</strong>
            <ul>
                <li>Try clicking the counter next to #9373 to test dropdown positioning</li>
                <li>Resize your browser window to different sizes and test again</li>
                <li>Scroll down to test the sticky counter</li>
                <li>Try the dropdown at different scroll positions</li>
                <li>Test navigation: use browser back/forward buttons</li>
                <li>Test programmatic navigation with the buttons below</li>
            </ul>
            <button onclick="testNavigation()">Test Navigation (History API)</button>
            <button onclick="testBackForward()">Test Back/Forward Detection</button>
        </div>

        <!-- Add spacer to test sticky counter and scroll positioning -->
        <div class="spacer"></div>
        
        <div class="comment">
            <p>This is way down the page to test sticky counter. Another @patrick-knight mention here!</p>
        </div>

        <!-- Test elements to simulate GitHub popups with high z-index -->
        <div class="fake-github-popup">
            Fake GitHub Popup<br>
            z-index: 999999
        </div>
        
        <div class="fake-github-modal">
            Fake GitHub Modal<br>
            z-index: 1000000
        </div>
    </div>

    <script>
        function loadMoreContent() {
            const moreContent = document.getElementById('more-content');
            moreContent.style.display = 'block';
            
            // Simulate the button being removed like GitHub does
            event.target.remove();
        }
        
        function testNavigation() {
            // Test pushState navigation
            console.log('Testing pushState navigation...');
            history.pushState({test: true}, '', '?test=' + Date.now());
        }
        
        function testBackForward() {
            // Test back/forward detection
            console.log('Testing back/forward - will go back in 2 seconds...');
            setTimeout(() => {
                history.back();
            }, 2000);
        }
    </script>

    <script src="content.js"></script>
</body>
</html>