/* Styles for Me @ GitHub extension using GitHub Primer Design System */

/* Counter badge using Primer tokens */
.me-at-github-counter {
  display: inline-flex !important;
  align-items: center;
  gap: var(--base-size-4, 4px);
  margin-left: var(--base-size-12, 12px);
  padding: var(--base-size-4, 4px) var(--base-size-8, 8px);
  background: var(--bgColor-accent-emphasis, #0969da) !important;
  color: var(--fgColor-onEmphasis, #ffffff) !important;
  border: var(--borderWidth-thin, 1px) solid transparent;
  border-radius: var(--borderRadius-full, 2rem);
  font-family: var(--fontStack-system, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif);
  font-size: var(--text-body-size-small, 12px);
  font-weight: var(--base-text-weight-medium, 500);
  line-height: var(--text-body-lineHeight-small, 1.6666);
  cursor: pointer;
  position: relative;
  transition: all var(--animation-duration-fast, 80ms) var(--animation-easing-glide, cubic-bezier(0.25, 1, 0.5, 1));
  vertical-align: middle;
  z-index: 1;
  white-space: nowrap;
  -webkit-user-select: none;
  user-select: none;
}

.me-at-github-counter:hover {
  background: var(--bgColor-accent-emphasis-hover, #0860ca) !important;
  transform: scale(1.05);
}

/* Sticky counter using Primer floating component styles */
.me-at-github-sticky-counter {
  display: none;
  position: fixed;
  top: var(--base-size-64, 64px);
  right: var(--base-size-16, 16px);
  align-items: center;
  justify-content: center;
  padding: var(--base-size-6, 6px) var(--base-size-8, 8px);
  min-width: var(--base-size-32, 32px);
  height: var(--base-size-28, 28px);
  background: var(--bgColor-accent-emphasis, #0969da) !important;
  color: var(--fgColor-onEmphasis, #ffffff) !important;
  border: var(--borderWidth-thin, 1px) solid var(--borderColor-accent-emphasis, #0969da);
  border-radius: var(--borderRadius-full, 2rem);
  font-family: var(--fontStack-system, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif);
  font-size: var(--text-caption-size, 12px);
  font-weight: var(--base-text-weight-medium, 500);
  line-height: var(--text-caption-lineHeight, 1.3333);
  cursor: pointer;
  box-shadow: var(--shadow-floating-small, 0 1px 3px rgba(16, 22, 26, 0.12), 0 1px 2px rgba(16, 22, 26, 0.24));
  z-index: 999999 !important;
  transition: all var(--animation-duration-fast, 80ms) var(--animation-easing-glide, cubic-bezier(0.25, 1, 0.5, 1));
  -webkit-backdrop-filter: blur(12px);
  backdrop-filter: blur(12px);
  pointer-events: auto;
  -webkit-user-select: none;
  user-select: none;
}

.me-at-github-sticky-counter:hover {
  background: var(--bgColor-accent-emphasis-hover, #0860ca) !important;
  transform: scale(1.1);
  box-shadow: var(--shadow-floating-medium, 0 4px 8px rgba(16, 22, 26, 0.12), 0 2px 4px rgba(16, 22, 26, 0.08));
}

.me-at-github-sticky-counter:active {
  transform: scale(0.95);
  transition: all var(--animation-duration-faster, 40ms) var(--animation-easing-glide, cubic-bezier(0.25, 1, 0.5, 1));
}

/* Dropdown menu using Primer Overlay component styles */
.me-at-github-dropdown {
  position: fixed;
  background: var(--bgColor-default, #ffffff) !important;
  border: var(--borderWidth-thin, 1px) solid var(--borderColor-default, #d1d9e0);
  border-radius: var(--borderRadius-medium, 6px);
  box-shadow: var(--shadow-floating-large, 0 16px 32px rgba(1, 4, 9, 0.1), 0 0 0 1px rgba(16, 22, 26, 0.1));
  min-width: var(--base-size-300, 300px);
  max-width: min(var(--base-size-500, 500px), calc(100vw - 32px));
  max-height: var(--base-size-400, 400px);
  overflow-y: auto;
  z-index: 2147483647 !important;
  font-family: var(--fontStack-system, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif);
  -webkit-backdrop-filter: blur(0px);
  backdrop-filter: blur(0px);
}

/* Force dropdown above all GitHub elements */
.me-at-github-dropdown {
  position: absolute !important;
}

/* Ensure dropdown appears above GitHub's mention suggestions and other popups */
body .me-at-github-dropdown {
  z-index: 2147483647 !important;
}

html .me-at-github-dropdown {
  z-index: 2147483647 !important;
}

/* Create new stacking context to force proper layering */
.me-at-github-dropdown {
  will-change: transform !important;
  transform: translateZ(0) !important;
}

/* Force above any potential GitHub overlays */
.me-at-github-dropdown {
  position: absolute !important;
  z-index: 2147483647 !important;
}

/* Target specific GitHub styled-components patterns */
*[class^="Box-"] + .me-at-github-counter .me-at-github-dropdown,
*[class*="Box-"] + .me-at-github-counter .me-at-github-dropdown,
*[class$="Box-"] + .me-at-github-counter .me-at-github-dropdown {
  z-index: 2147483647 !important;
}

/* Override GitHub's Box components and styled-components */
.me-at-github-dropdown {
  isolation: isolate !important;
}

/* Force above GitHub Box components */
[class*="Box-"] ~ .me-at-github-dropdown {
  z-index: 2147483647 !important;
}

/* Force above specific GitHub components that are causing issues */
.Box-sc-g0xbh4-0 ~ .me-at-github-dropdown,
.crMLA-D ~ .me-at-github-dropdown,
*[class*="crMLA"] ~ .me-at-github-dropdown {
  z-index: 2147483647 !important;
}

/* Ensure dropdown container creates new stacking context */
.me-at-github-counter {
  position: relative !important;
  z-index: 2147483647 !important;
  isolation: isolate !important;
}

.me-at-github-dropdown * {
  z-index: inherit !important;
}

/* Override GitHub's Box components and styled-components */
.me-at-github-dropdown {
  z-index: 2147483647 !important;
  position: absolute !important;
  isolation: isolate !important;
}

/* Force above GitHub Box components */
[class*="Box-"] ~ .me-at-github-dropdown,
.me-at-github-dropdown {
  z-index: 2147483647 !important;
}

/* Force above specific GitHub components */
.Box-sc-g0xbh4-0 ~ .me-at-github-dropdown,
.crMLA-D ~ .me-at-github-dropdown,
*[class*="crMLA"] ~ .me-at-github-dropdown {
  z-index: 2147483647 !important;
}

/* Ensure dropdown container creates new stacking context */
.me-at-github-counter {
  position: relative !important;
  z-index: 2147483647 !important;
  isolation: isolate !important;
}

/* Dropdown positioning variants - positioning handled by JS with inline styles */
.me-at-github-dropdown-center {
  max-width: calc(100vw - 32px);
}

.me-at-github-dropdown-mobile {
  width: auto;
  min-width: auto;
  max-width: none;
  z-index: 2147483647 !important;
}

.me-at-github-dropdown-list {
  list-style: none;
  margin: 0;
  padding: var(--base-size-8, 8px) 0;
}

.me-at-github-dropdown-item {
  display: flex;
  align-items: flex-start;
  gap: var(--base-size-8, 8px);
  padding: var(--base-size-8, 8px) var(--base-size-16, 16px);
  cursor: pointer;
  transition: background-color var(--animation-duration-fast, 80ms) var(--animation-easing-glide, cubic-bezier(0.25, 1, 0.5, 1));
  border-bottom: var(--borderWidth-thin, 1px) solid var(--borderColor-muted, #d1d9e0b3);
}

.me-at-github-dropdown-item:last-child {
  border-bottom: none;
}

.me-at-github-dropdown-item:hover {
  background: var(--bgColor-muted, #f6f8fa);
}

.me-at-github-dropdown-index {
  display: inline-block;
  min-width: var(--base-size-30, 30px);
  color: var(--fgColor-muted, #656d76);
  font-weight: var(--base-text-weight-medium, 500);
  font-size: var(--text-caption-size, 12px);
  line-height: var(--text-caption-lineHeight, 1.3333);
  flex-shrink: 0;
}

/* Dropdown context text using Primer typography */
.me-at-github-dropdown-context {
  flex: 1;
  font-size: var(--text-body-size-small, 12px);
  color: var(--fgColor-muted, #656d76);
  line-height: var(--text-body-lineHeight-small, 1.6666);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: var(--base-size-280, 280px);
}

.me-at-github-dropdown-context strong {
  color: var(--fgColor-accent, #0969da);
  font-weight: var(--base-text-weight-semibold, 600);
}

/* Line number in dropdown context using Primer muted styling */
.me-at-github-line-number {
  color: var(--fgColor-subtle, #8b949e);
  font-size: var(--text-caption-size, 12px);
  font-weight: var(--base-text-weight-normal, 400);
  margin-right: var(--base-size-6, 6px);
  opacity: 0.8;
}

/* Mention highlighting using Primer attention colors */
.me-at-github-mention {
  display: inline !important;
}

.me-at-github-mention-text {
  position: relative;
  display: inline !important;
  background: var(--bgColor-attention-muted, rgba(212, 167, 44, 0.1)) !important;
  color: var(--fgColor-default, #1f2328) !important;
  padding: var(--base-size-2, 2px) var(--base-size-4, 4px);
  border-radius: var(--borderRadius-small, 3px);
  border: var(--borderWidth-thin, 1px) solid var(--borderColor-attention-muted, rgba(212, 167, 44, 0.4));
  font-family: var(--fontStack-system, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif);
  font-weight: var(--base-text-weight-semibold, 600);
  transition: all var(--animation-duration-fast, 80ms) var(--animation-easing-glide, cubic-bezier(0.25, 1, 0.5, 1));
  -webkit-box-decoration-break: clone;
  box-decoration-break: clone;
}

.me-at-github-mention-text:hover {
  background: var(--bgColor-attention-muted-hover, rgba(212, 167, 44, 0.15)) !important;
  border-color: var(--borderColor-attention-emphasis, #bf8700);
  box-shadow: 0 0 0 var(--base-size-2, 2px) var(--borderColor-attention-muted, rgba(212, 167, 44, 0.15));
}

.me-at-github-mention-text.active {
  background: var(--bgColor-attention-emphasis, #bf8700) !important;
  border-color: var(--borderColor-attention-emphasis, #bf8700);
  box-shadow: 0 0 0 var(--base-size-2, 2px) var(--borderColor-attention-muted, rgba(212, 167, 44, 0.4));
  color: var(--fgColor-onEmphasis, #ffffff) !important;
}

/* Link wrapper for GitHub's native mentions */
.me-at-github-link-wrapper {
  display: inline-block;
  border-radius: 3px;
}

.me-at-github-link-wrapper a.user-mention {
  color: inherit !important;
  text-decoration: none !important;
  font-weight: inherit !important;
}

/* Ensure mention links maintain proper styling */
.me-at-github-mention-text a,
.me-at-github-mention-text a:visited,
.me-at-github-mention-text a:hover,
.me-at-github-mention-text a:active {
  color: inherit !important;
  text-decoration: none !important;
  background: none !important;
}

/* Navigation controls using Primer Overlay positioning */
.me-at-github-nav {
  display: none !important;
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  margin-top: var(--base-size-4, 4px);
  background: var(--bgColor-default, #ffffff);
  border: var(--borderWidth-thin, 1px) solid var(--borderColor-default, #d1d9e0);
  border-radius: var(--borderRadius-medium, 6px);
  padding: var(--base-size-4, 4px);
  box-shadow: var(--shadow-floating-small, 0 1px 3px rgba(16, 22, 26, 0.12), 0 1px 2px rgba(16, 22, 26, 0.24));
  white-space: nowrap;
  z-index: 2147483646 !important;
  align-items: center;
  gap: var(--base-size-4, 4px);
  visibility: hidden;
  opacity: 0;
  pointer-events: none;
  font-family: var(--fontStack-system, -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif);
}

/* Navigation shows on hover and stays visible longer */
.me-at-github-mention-text:hover .me-at-github-nav,
.me-at-github-mention-text.active .me-at-github-nav {
  display: flex !important;
  visibility: visible !important;
  opacity: 1 !important;
  pointer-events: auto !important;
}

.me-at-github-nav:hover {
  display: flex !important;
  visibility: visible !important;
  opacity: 1 !important;
  pointer-events: auto !important;
}

.me-at-github-nav-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: var(--base-size-24, 24px);
  height: var(--base-size-24, 24px);
  border: var(--borderWidth-thin, 1px) solid var(--borderColor-default, #d1d9e0);
  background: var(--bgColor-default, #ffffff);
  border-radius: var(--borderRadius-small, 3px);
  cursor: pointer;
  font-size: var(--text-body-size-medium, 14px);
  color: var(--fgColor-default, #1f2328);
  transition: all var(--animation-duration-fast, 80ms) var(--animation-easing-glide, cubic-bezier(0.25, 1, 0.5, 1));
  -webkit-user-select: none;
  user-select: none;
}

.me-at-github-nav-btn:hover {
  background: var(--bgColor-muted, #f6f8fa);
  border-color: var(--borderColor-default-hover, #8c959f);
}

.me-at-github-nav-btn:active {
  background: var(--bgColor-muted-active, #eaeef2);
  border-color: var(--borderColor-default-active, #8c959f);
}

.me-at-github-nav-index {
  padding: 0 var(--base-size-8, 8px);
  font-size: var(--text-caption-size, 12px);
  color: var(--fgColor-muted, #656d76);
  font-weight: var(--base-text-weight-medium, 500);
  line-height: var(--text-caption-lineHeight, 1.3333);
}

/* Dark mode support using Primer dark theme tokens */
@media (prefers-color-scheme: dark) {
  .me-at-github-dropdown {
    background: var(--bgColor-default, #0d1117) !important;
    border-color: var(--borderColor-default, #30363d);
    box-shadow: var(--shadow-floating-large, 0 16px 32px rgba(1, 4, 9, 0.1), 0 0 0 1px rgba(240, 246, 252, 0.1));
    z-index: 2147483647 !important;
  }
  
  .me-at-github-dropdown-center {
    box-shadow: var(--shadow-floating-large, 0 16px 32px rgba(1, 4, 9, 0.1), 0 0 0 1px rgba(240, 246, 252, 0.1));
  }
  
  .me-at-github-nav {
    background: var(--bgColor-default, #0d1117) !important;
    border-color: var(--borderColor-default, #30363d);
    box-shadow: var(--shadow-floating-small, 0 1px 3px rgba(16, 22, 26, 0.12), 0 1px 2px rgba(16, 22, 26, 0.24));
    z-index: 2147483646 !important;
  }
  
  .me-at-github-dropdown-item {
    border-bottom-color: var(--borderColor-muted, #21262db3);
  }
  
  .me-at-github-dropdown-item:hover {
    background: var(--bgColor-muted, #21262d);
  }
  
  .me-at-github-dropdown-index {
    color: var(--fgColor-muted, #7d8590);
  }
  
  .me-at-github-dropdown-context {
    color: var(--fgColor-default, #e6edf3);
  }
  
  .me-at-github-dropdown-context strong {
    color: var(--fgColor-accent, #4493f8);
  }
  
  .me-at-github-line-number {
    color: var(--fgColor-subtle, #6e7681);
  }
  
  .me-at-github-mention-text {
    background: var(--bgColor-attention-muted, rgba(187, 128, 9, 0.15)) !important;
    color: var(--fgColor-default, #e6edf3) !important;
    border-color: var(--borderColor-attention-muted, rgba(187, 128, 9, 0.4));
  }
  
  .me-at-github-mention-text:hover {
    background: var(--bgColor-attention-muted-hover, rgba(187, 128, 9, 0.25)) !important;
    border-color: var(--borderColor-attention-emphasis, #d29922);
    box-shadow: 0 0 0 var(--base-size-2, 2px) var(--borderColor-attention-muted, rgba(187, 128, 9, 0.25));
  }
  
  .me-at-github-mention-text.active {
    background: var(--bgColor-attention-emphasis, #d29922) !important;
    border-color: var(--borderColor-attention-emphasis, #d29922);
    box-shadow: 0 0 0 var(--base-size-2, 2px) var(--borderColor-attention-muted, rgba(187, 128, 9, 0.4));
    color: var(--fgColor-onEmphasis, #1f2328) !important;
  }
  
  .me-at-github-link-wrapper a.user-mention {
    color: inherit !important;
  }
  
  .me-at-github-mention-text a,
  .me-at-github-mention-text a:visited,
  .me-at-github-mention-text a:hover,
  .me-at-github-mention-text a:active {
    color: inherit !important;
  }
  
  .me-at-github-sticky-counter {
    background: #58a6ff !important;
    border-color: rgba(255, 255, 255, 0.1);
    color: #000000 !important;
  }
  
  .me-at-github-sticky-counter:hover {
    background: #4493f8 !important;
    color: #000000 !important;
  }
  
  .me-at-github-nav {
    background: #161b22;
    border-color: #30363d;
    box-shadow: 0 4px 12px rgba(1, 4, 9, 0.3);
  }
  
  .me-at-github-nav-btn {
    background: #161b22;
    border-color: #30363d;
    color: #c9d1d9;
  }
  
  .me-at-github-nav-btn:hover {
    background: #21262d;
    border-color: #c9d1d9;
  }
  
  .me-at-github-nav-btn:active {
    background: #30363d;
  }
  
  .me-at-github-nav-index {
    color: #8b949e;
  }
  
  /* Dark mode Box component overrides */
  [class*="Box-"] ~ .me-at-github-dropdown,
  .Box-sc-g0xbh4-0 ~ .me-at-github-dropdown,
  .crMLA-D ~ .me-at-github-dropdown {
    z-index: 2147483647 !important;
    background: #161b22 !important;
  }
  
  .me-at-github-counter {
    z-index: 2147483647 !important;
  }
}

/* Body-level dropdown portal to escape stacking context issues */
.me-at-github-dropdown-portal {
  position: fixed !important;
  z-index: 2147483647 !important;
  background: white !important;
  border: 1px solid #d0d7de !important;
  border-radius: 6px !important;
  box-shadow: 0 8px 24px rgba(140, 149, 159, 0.2) !important;
  min-width: 300px !important;
  max-width: 500px !important;
  max-height: 400px !important;
  overflow-y: auto !important;
}

/* Aggressive navigation control hiding */
.me-at-github-nav {
  display: none !important;
}

/* Only show when explicitly hovered */
.me-at-github-mention-text:hover .me-at-github-nav {
  display: flex !important;
}

/* Hide navigation controls completely if there's only one mention */
.me-at-github-mention-text .me-at-github-nav {
  display: none !important;
}

@media (prefers-color-scheme: dark) {
  .me-at-github-dropdown-portal {
    background: #161b22 !important;
    border-color: #30363d !important;
    box-shadow: 0 8px 24px rgba(1, 4, 9, 0.3) !important;
  }
}
